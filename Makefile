COMPILER = g++
COMPILER_DONT_LINK_OPTION = -c
COMPILER_OUTPUT_OPTION = -o
COMPILER_WARNING_OPTION = -Wall -Wextra
SOURCE_DIRECTORY = src
SOURCE_SUFFIX = .cpp
SOURCES = $(wildcard $(SOURCE_DIRECTORY)/*$(SOURCE_SUFFIX))
OBJECT_DIRECTORY = obj
OBJECT_SUFFIX = .o
OBJECTS = $(patsubst $(SOURCE_DIRECTORY)/%, $(OBJECT_DIRECTORY)/%, $(patsubst %$(SOURCE_SUFFIX), %$(OBJECT_SUFFIX), $(SOURCES)))
TARGET = GenImg

$(TARGET): $(OBJECTS)
	$(COMPILER) $^ $(COMPILER_WARNING_OPTION) $(COMPILER_OUTPUT_OPTION) $@

$(OBJECTS): $(patsubst $(OBJECT_DIRECTORY)/%, $(SOURCE_DIRECTORY)/%, $(patsubst %$(OBJECT_SUFFIX), %$(SOURCE_SUFFIX), $@))

$(OBJECT_DIRECTORY)/%$(OBJECT_SUFFIX): $(SOURCE_DIRECTORY)/%$(SOURCE_SUFFIX)
	$(COMPILER) $^ $(COMPILER_DONT_LINK_OPTION) $(COMPILER_WARNING_OPTION) $(COMPILER_OUTPUT_OPTION) $@

clean:
	for i in $(TARGET) $(OBJECTS); do	\
		if [ -e $$i ]; then		\
			rm $$i;			\
		fi;				\
	done

rebuild: clean
	make

.PHONY: clean rebuild

